# 私有连接产品手册

# 文档目录结构

## 产品简介

### 产品概述

私有连接能够通过内网建立服务使用者与服务提供者之间安全、简单的网络连接，由终端节点和终端节点服务两部分组成，其中终端节点服务由服务提供方提供，是提供服务的实例；终端节点由服务使用者创建。使用者通过终端节点来访问终端节点服务提供的服务。

产品范围为终端节点服务和终端节点同地域，且终端节点为VPC网络的场景，对于终端节点是跨地域或跨网络类型，应使用云联网产品与终端节点VPC网络打通，然后使用终端节点服务。

### 名词解释

<table>
  <tr>
    <th><b>类型</b></th>
    <th><b>名词</b></th>
    <th><b>描述</b></th>
  </tr>
  <tr>
    <td rowspan="2">服务提供方</td>
    <td>终端节点服务</td>
    <td>由服务提供方创建与管理，可被其他VPC通过创建终端节点建立私网连接的服务</td>
  </tr>
  <tr>
    <td>服务资源</td>
    <td>终端节点服务中可以被终端节点访问的资源，一般指内网网络型负载均衡。</td>
  </tr>
  <tr>
    <td>服务使用者</td>
    <td>终端节点</td>
    <td>由服务使用者创建与管理，可与终端节点服务建立私网连接。是终端节点VPC访问终端节点服务的入口。</td>
  </tr>
</table>

### 使用限制

#### 配额限制

<table>
  <tr>
    <th><b>实例</b></th>
    <th><b>资源</b></th>
    <th><b>默认限制</b></th>
  </tr>
  <tr>
    <td rowspan="5">终端节点服务</td>
    <td>单个账号可创建的终端节点服务的数量</td>
    <td>100个</td>
  </tr>
  <tr>
    <td>单个终端节点服务可添加的服务资源的数量</td>
    <td>1个</td>
  </tr>
   <tr>
    <td>终端节点服务后端服务资源支持的资源类型</td>
    <td>应用型负载均衡，网络型负载均衡</td>
  </tr>
   <tr>
    <td>终端节点服务支持的流量</td>
    <td>IPv4,<b>双栈</b></td>
  </tr>
   <tr>
    <td>终端节点服务支持的协议</td>
    <td>TCP、UDP（仅支持这两种或基于这两种之上的协议）</td>
  </tr>
  <tr>
    <td rowspan="5">终端节点</td>
    <td>终端节点数量</td>
    <td>50</td>
  </tr>
  <tr>
    <td>单个VPC到单个终端节点服务的终端节点数量</td>
    <td>1个</td>
  </tr>
   <tr>
    <td>终端节点支持的流量</td>
    <td>IPv4,<b>双栈</b></td>
  </tr>
   <tr>
    <td>单个终端节点网卡可支持的带宽</td>
    <td>100-10240Mbps</td>
  </tr>
   <tr>
    <td>终端节点支持的协议</td>
    <td>TCP、UDP</td>
  </tr>
</table>

#### 其他限制

不支持跨地域的私有连接

## 购买指南

### 计费规则

本文主要介绍私有连接的计费项和计费逻辑信息。

#### 计费项

私有连接的计费项分为实例费用和流量处理费用。

| 计费项       | 计费模式 | 计费周期   | 计费项说明                                     | 单价      |
| ------------ | -------- | ---------- | ---------------------------------------------- | --------- |
| 终端节点实例 | 按量付费 | 按小时结算 | 终端节点实例费用                               | 0.07/元/h |
| 终端节点流量 | 按量付费 | 按小时结算 | 进出终端节点网卡的双向流量，每小时生产流量订单 | 0.07元/GB |

#### 计费逻辑

终端节点和终端节点服务可以属于不同的账号，所以在创建终端节点服务时，**可以选择该终端节点服务相关的终端节点所产生的费用，是由服务提供方承担，还是服务使用方承担**。

| 付费方             | 说明                                                         |
| ------------------ | ------------------------------------------------------------ |
| 服务使用者（默认） | 由创建终端节点的账号承担终端节点所产生的费用，包括终端节点的实例费，以及流量费 |
| 服务提供者         | 由创建终端节点服务的账号承担与这个终端节点服务相关联的全部终端节点所产生的费用，包括产生的实例费，和流量费； |

> 注意说明：
>
> - 在计算实例费时，最小计费粒度为1h，不满1h的，按1h计算；
> - 在一个计费周期内，终端节点/终端节点服务如发生变化，包括断开连接，更换服务资源，删除终端节点服务，不会影响终端节点的付费发生变化；
> - 无论付费方是哪个账号，计量计费项的对象不变，都是终端节点作为计费对象；
> - 在创建终端节点服务时，选定的付费方后，后续无法对付费方进行更新；
> - 计费周期从终端节点与终端节点服务建立连接开始计算，断开连接就终止；
> - **除已连接状态的终端节点实例外，其他状态的终端节点实例（未连接，已断开）不能创建超过10个，单地域维度限制。**

### 欠费说明

若实例到期或产生欠费，为保证您私有连接实例服务的正常使用，请您及时续费或充值。

- 当付费方账户余额不足时，从余额为0的时刻开始，2小时内终端节点/终端服务节点实例可继续使用且继续扣费。
- 2小时后，若付费账户余额仍未充值到大于0，终端节点/终端服务节点实例将自动停止服务并停止扣费。
- 终端节点/终端服务节点实例停止服务后的24小时内，付费账户余额仍未充值到大于0，则保持为不可用状态；若到余额大于0，则实例重新可用，且计费重新开始。
- 终端节点/终端服务节点实例停止服务后，余额小于0的时间达到24小时，实例将被立即回收，**不可恢复**。

> 注意说明：
>
> - 在欠费停服期间，如付费方是服务使用者，则仅影响服务使用者实例不可使用；如付费方是服务提供者，则会影响该服务提供者绑定的终端节点不可用；
> - 欠费回收时，如付费方是服务使用者，则仅对欠费的服务使用者实例进行回收；如付费方是服务提供者，则需要对服务提供者实例进行回收，**该服务的终端节点实例，均保持断开状态；**
> - 停止服务，是指终端节点与终端节点服务的服务断开。

## 快速入门

### 前提条件

同一地域下拥有私有网络VPC1，私有网络VPC2，因业务需求，私有网络VPC1需要访问私有网络VPC2中的相关服务资源。为避免通过公网渠道进行访问使用相关服务资源，增加潜在网络安全风险，可在私有网络VPC1和私有网络VPC2中建立私有连接，通过安全内网进行访问。

### 场景图示

![](D:\Documents\Github\privatelink\images\场景图示.png)

### 使用流程

![](D:\Documents\Github\privatelink\images\使用流程.png)

### 配置流程

#### 1.服务提供方创建终端节点服务

1.登录私有网络控制台。

2.在实列表详情页，点击创建**终端节点服务**。

3.在**终端节点服务**创建页面，完成以下配置：

| 配置                 | 说明                                             | 是否必填 |
| -------------------- | ------------------------------------------------ | -------- |
| 服务名称             | 输入自定义终端节点服务名称                       | 是       |
| 地域                 | 选择终端节点服务所属的地域                       | 是       |
| 业务组               | 选择终端节点要归属的业务组                       | 否       |
| 服务资源类型         | 选择需创建服务的资源类型                         | 是       |
| 选择服务资源         | 选择需创建服务的资源                             | 是       |
| 选择服务IP           | 选择所属服务IP                                   | 是       |
| 自动接收终端节点连接 | 是否自动接收终端节点连接申请                     | 是       |
| 费用承担方           | 设置私有连接费用承担者为服务提供方还是服务使用方 | 是       |
| 备注                 | 备注其他信息                                     | 否       |

4.点击确定，然后根据控制台提示完成终端节点服务的创建。

5.返回**终端节点服务列表页**，选择对应的地域即可看到新建的实例。

#### 2.服务使用方创建终端节点并发送连接申请

1.登录私有网络控制台。

2.在实列表详情页，点击创建**终端节点**。

3.在**终端节点**创建页面，完成以下配置：

| 配置         | 说明                                                         | 是否必填 |
| ------------ | ------------------------------------------------------------ | -------- |
| 名称         | 输入自定义终端节点名称                                       | 是       |
| 地域         | 选择终端节点所属的地域                                       | 是       |
| 所属VPC      | 选择终端节点所属的VPC                                        | 是       |
| 所属子网     | 选择终端节点所属的子网                                       | 是       |
| IP地址       | 可以选择随实例创建时自动分配IP地址，或手动填入IP地址         | 是       |
| 终端节点服务 | 选择需连接的终端节点服务，可选择当前账户同属也可选择其他账户所属的终端节点服务 | 是       |
| 业务组       | 选择终端节点所归属分类的业务组                               | 否       |
| 备注         | 备注其他信息                                                 | 否       |

4.点击确定，然后根据控制台提示完成终端节点服务的创建。

5.返回**终端节点服务列表页**，选择对应的地域即可看到新建的实例。

#### 3.服务提供方同意连接，完成私有连接搭建 

1.登录私有网络控制台。

2.在顶部菜单栏，选择终端节点复苏所属的地域。

3.在终端节点服务列表页，选择需要管理连接的实例，单击操作列选择更多。

4.点击实例详情页的终端节点tag，对列表内的终端节点进行管理。

5.点击操作列的允许连接或拒绝连接，对终端节点进行管理。

## 操作指南

主要介绍产品的基础使用方法，以及控制台的操作使用流程

### 终端节点服务

#### 创建终端节点服务

1.登录私有网络控制台。

2.在实列表详情页，点击创建**终端节点服务**。

3.在**终端节点服务**创建页面，完成以下配置：

| 配置                 | 说明                                             | 是否必填 |
| -------------------- | ------------------------------------------------ | -------- |
| 服务名称             | 输入自定义终端节点服务名称                       | 是       |
| 地域                 | 选择终端节点服务所属的地域                       | 是       |
| 业务组               | 选择终端节点要归属的业务组                       | 否       |
| 服务资源类型         | 选择需创建服务的资源类型                         | 是       |
| 选择服务资源         | 选择需创建服务的资源                             | 是       |
| 选择服务IP           | 选择所属服务IP                                   | 是       |
| 自动接收终端节点连接 | 是否自动接收终端节点连接申请                     | 是       |
| 费用承担方           | 设置私有连接费用承担者为服务提供方还是服务使用方 | 是       |
| 备注                 | 备注其他信息                                     | 否       |

4.点击确定，然后根据控制台提示完成终端节点服务的创建。

5.返回**终端节点服务列表页**，选择对应的地域即可看到新建的实例。

#### 修改终端节点服务信息

1.登录私有网络控制台。

2.在顶部菜单栏，选择终端节点服务所属的地域。

3.在终端节点服务列表页，选择需要修改的终端节点服务，单击操作列中更多按钮，进入实例详情页。

4.根据所需要修改的信息，点击后方的编辑按钮进行修改。

5.在修改弹窗中，修改信息，然后单击确定。

#### 删除终端节点服务

1.登录私有网络控制台。

2.在顶部菜单栏，选择终端节点服务所属的地域。

3.在终端节点服务列表页，选择需要删除的终端节点服务，单击操作列选择删除。

4.在删除实例弹窗，单击确定。

#### 管理终端节点连接

1.登录私有网络控制台。

2.在顶部菜单栏，选择终端节点复苏所属的地域。

3.在终端节点服务列表页，选择需要管理连接的实例，单击操作列选择更多。

4.点击实例详情页的终端节点tag，对列表内的终端节点进行管理。

5.点击操作列的允许连接或拒绝连接，对终端节点进行管理。

#### 查看监控信息

1.登录私有网络控制台。

2.在顶部菜单栏，选择终端节点复苏所属的地域。

3.在终端节点服务列表页，选择需要管理连接的实例，单击操作列选择更多。

4.点击实例详情页的监控tag，查看终端节点服务相关监控信息。

#### 更换服务资源

1.登录私有网络控制台。

2.在顶部菜单栏，选择终端节点复苏所属的地域。

3.在终端节点服务列表页，选择需要管理连接的实例，单击操作列选择更换服务资源。

4.在更换服务资源窗口，根据业务需求更换以下配置：

| 配置         | 说明                                   | 是否必填 |
| ------------ | -------------------------------------- | -------- |
| 服务资源类型 | 选择需更换的服务资源类型               | 是       |
| 服务资源     | 选择更换的服务资源类型中所含的服务资源 | 是       |
| 服务IP       | 仅可选择同原IP同协议类型的IP           | 是       |

5.点击确定按钮，完成对终端节点服务资源的更换。**【更换服务资源是否需要关机处理，或对终端节点进行提示？】**

#### 添加白名单

1.登录私有网络控制台。

2.在顶部菜单栏，选择终端节点复苏所属的地域。

3.在终端节点服务列表页，选择需要管理连接的实例，单击操作列选择白名单管理。

4.在白名单管理窗口内填写需加入白名单的Company id，并根据需要填写备注。

**【搜索填写公司ID是否可以给出公司名称，以确保填写无误】**

5.点击确定按钮，完成白名单添加。

### 终端节点

#### 创建终端节点

1.登录私有网络控制台。

2.在实列表详情页，点击创建**终端节点**。

3.在**终端节点**创建页面，完成以下配置：

| 配置         | 说明                                                         | 是否必填 |
| ------------ | ------------------------------------------------------------ | -------- |
| 名称         | 输入自定义终端节点名称                                       | 是       |
| 地域         | 选择终端节点所属的地域                                       | 是       |
| 所属VPC      | 选择终端节点所属的VPC                                        | 是       |
| 所属子网     | 选择终端节点所属的子网                                       | 是       |
| IP地址       | 可以选择随实例创建时自动分配IP地址，或手动填入IP地址         | 是       |
| 终端节点服务 | 选择需连接的终端节点服务，可选择当前账户同属也可选择其他账户所属的终端节点服务 | 是       |
| 业务组       | 选择终端节点所归属分类的业务组                               | 否       |
| 备注         | 备注其他信息                                                 | 否       |

4.点击确定，然后根据控制台提示完成终端节点服务的创建。

5.返回**终端节点服务列表页**，选择对应的地域即可看到新建的实例。

#### 修改终端节点信息

1.登录私有网络控制台。

2.在顶部菜单栏，选择终端节点所属的地域。

3.在终端节点列表页，选择需要修改的终端节点实例，单击操作列中更多按钮，进入实例详情页。

4.根据所需要修改的信息，点击后方的编辑按钮进行修改。

5.在修改弹窗中，修改信息，然后单击确定。

#### 删除终端节点

1.登录私有网络控制台。

2.在顶部菜单栏，选择终端节点所属的地域。

3.在终端节点列表页，选择需要删除的终端节点，单击操作列选择删除。

4.在删除实例弹窗，单击确定。

#### 查询连接终端节点服务信息

1.登录私有网络控制台。

2.在顶部菜单栏，选择终端节点所属的地域。

3.在终端节点列表页，选择需要修改的终端节点实例，单击操作列中更多按钮，进入实例详情页。

4.可在实例详情页查看到连接的终端节点服务信息。

#### 管理安全组

1.登录私有网络控制台。

2.在顶部菜单栏，选择终端节点所属的地域。

3.在终端节点列表页，选择需要修改的终端节点实例，单击操作列中更多按钮，进入实例详情页。

4.点击实例详情页的安全组tag，对列表内的安全组进行管理。

5.点击操作列移除按钮，可移除当前安全组限制；点击绑定安全组按钮，可绑定新的安全组到当前终端节点实例上。

#### 查看终端节点监控信息

1.登录私有网络控制台。

2.在顶部菜单栏，选择终端节点所属的地域。

3.在终端节点列表页，选择需要修改的终端节点实例，单击操作列中更多按钮，进入实例详情页。

4.点击实例详情页的监控tag，可查看终端节点监控信息。

### 监控项【待补充】

## 最佳实践

### 不同账户下的VPC服务共享连接

#### 1.服务提供方创建终端节点服务

1.登录私有网络控制台。

2.在实列表详情页，点击创建**终端节点服务**。

3.在**终端节点服务**创建页面，完成以下配置：

| 配置                 | 说明                                             | 是否必填 |
| -------------------- | ------------------------------------------------ | -------- |
| 服务名称             | 输入自定义终端节点服务名称                       | 是       |
| 地域                 | 选择终端节点服务所属的地域                       | 是       |
| 业务组               | 选择终端节点要归属的业务组                       | 否       |
| 服务资源类型         | 选择需创建服务的资源类型                         | 是       |
| 选择服务资源         | 选择需创建服务的资源                             | 是       |
| 选择服务IP           | 选择所属服务IP                                   | 是       |
| 自动接收终端节点连接 | 是否自动接收终端节点连接申请                     | 是       |
| 费用承担方           | 设置私有连接费用承担者为服务提供方还是服务使用方 | 是       |
| 备注                 | 备注其他信息                                     | 否       |

4.点击确定，然后根据控制台提示完成终端节点服务的创建。

5.返回**终端节点服务列表页**，选择对应的地域即可看到新建的实例。

#### 2.服务使用方创建终端节点并向不同账号下终端节点服务发送连接申请

1.登录私有网络控制台。

2.在实列表详情页，点击创建**终端节点**。

3.在**终端节点**创建页面，完成以下配置：

| 配置         | 说明                                                         | 是否必填 |
| ------------ | ------------------------------------------------------------ | -------- |
| 名称         | 输入自定义终端节点名称                                       | 是       |
| 地域         | 选择终端节点所属的地域                                       | 是       |
| 所属VPC      | 选择终端节点所属的VPC                                        | 是       |
| 所属子网     | 选择终端节点所属的子网                                       | 是       |
| IP地址       | 可以选择随实例创建时自动分配IP地址，或手动填入IP地址         | 是       |
| 终端节点服务 | 选择需连接的终端节点服务，可选择当前账户同属也可选择其他账户所属的终端节点服务 | 是       |
| 业务组       | 选择终端节点所归属分类的业务组                               | 否       |
| 备注         | 备注其他信息                                                 | 否       |

4.在配置连接终端节点服务时，选择其他账号服务，并填写终端节点服务验证码进行申请配置。

5.点击确定，然后根据控制台提示完成终端节点服务的创建。

6.返回**终端节点服务列表页**，选择对应的地域即可看到新建的实例。

#### 3.服务提供方同意连接，完成私有连接搭建

1.登录私有网络控制台。

2.在顶部菜单栏，选择终端节点复苏所属的地域。

3.在终端节点服务列表页，选择需要管理连接的实例，单击操作列选择更多。

4.点击实例详情页的终端节点tag，对列表内的终端节点进行管理。

5.点击操作列的允许连接或拒绝连接，对终端节点进行管理。

## 开发指南【待补充】

### API

当前产品提供的API接口，以及使用方式，和示例；

### SDK

当前产品支持的SDK，以及每个SDK的的方法

## 常见问题

### 如果想跨地域进行私有连接，如何操作？

暂不支持跨地域进行私有连接操作。若想进行跨地域使用服务资源，可使用其他混合云连接服务建立连接，如云联网、VPN连接等，实现VPC之间跨域连接共享服务资源。

### 同账户下的VPC能否自动接受终端节点连接请求？

在初始创建终端节点服务时可选择是否自动接收终端节点连接。若创建时未勾选，后续可在终端节点服务信息页进行修改即可。

### 带宽问题【2】

带宽是服务方调整后，连接的所有终端节点都进行调整，还是需要针对连接上的终端节点一个一个进行调整？

调整后的终端节点带宽即时生效吗？

### 付费方式问题【3】

付费方式能否进行修改？

收费信息等在哪边可以进行查看？终端节点还是终端节点服务，还是付费方？

一个终端节点服务如果选择费用承担方为终端节点，那么可以即连接按流量收费的终端节点又连接按时间收费的终端节点吗？

### 连接问题【2】

删除终端节点服务前需要通知断开所有已连接上的终端节点吗？或者出现重要提示其还处于连接状态的终端节点？

终端节点端，若其相连接的终端节点服务被删除，是否给予提示或其他提醒？

## 相关协议

服务等级协议

服务条款
